(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3411:function(t,e,r){Promise.resolve().then(r.bind(r,6009)),Promise.resolve().then(r.t.bind(r,5455,23))},6493:function(t,e,r){"use strict";r.d(e,{BJ:function(){return a},BZ:function(){return d},Fw:function(){return _},Iq:function(){return c},Ns:function(){return h},ZB:function(){return l},d8:function(){return o},jo:function(){return m},li:function(){return i},v_:function(){return f}});let n=async t=>{try{let e=await fetch(t);if(200!==e.status)throw Error("Ошибка получения данных");return await e.json()}catch(t){return t}},o=t=>!(t instanceof Error),u=t=>{let e=JSON.stringify(t),r=JSON.parse(e=e.replaceAll("_id","id"));return{...r,category:r.categories}},s=t=>t.map(t=>u(t)),i=async(t,e)=>{let r=await n("".concat(t,"/").concat(e));return o(r)?u(r):r},a=async(t,e)=>{try{let r=await n("".concat(t,"?categories.name=").concat(e));if(!r.length)throw Error("Нет игр в категории");return o(r)?s(r):r}catch(t){return t}},c=async(t,e)=>{try{let r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(200!==r.status)throw Error("Ошибка авторизации");return await r.json()}catch(t){return t}},l=t=>{document.cookie="jwt=".concat(t),localStorage.setItem("jwt",t)},f=()=>{if(""===document.cookie)return localStorage.getItem("jwt");let t=document.cookie.split(";").find(t=>t.includes("jwt"));return t?t.split("=")[1]:null},_=()=>{document.cookie="jwt=;",localStorage.removeItem("jwt")},m=async(t,e)=>{try{let r=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(200!==r.status)throw Error("Ошибка получения данных");return await r.json()}catch(t){return t}},d=(t,e)=>t.users.find(t=>t.id===t),h=async(t,e,r)=>{try{let n=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({users:r})});if(200!==n.status)throw Error("Ошибка голосования");return await n.json()}catch(t){return t}}},1370:function(t,e,r){"use strict";r.d(e,{H:function(){return o}});let n="https://goshapindieyp.nomoredomainswork.ru/api",o={games:"".concat(n,"/games"),auth:"".concat(n,"/auth/login"),me:"".concat(n,"//me")}},6009:function(t,e,r){"use strict";r.r(e),r.d(e,{AuthForm:function(){return l}});var n=r(7437),o=r(7965),u=r.n(o),s=r(2265),i=r(1370),a=r(6493),c=r(3080);let l=t=>{let e=(0,c.o)(),[r,o]=(0,s.useState)({email:"",password:""}),[l,f]=(0,s.useState)({status:null,text:null}),_=t=>{o({...r,[t.target.name]:t.target.value})},m=async t=>{t.preventDefault();let n=await (0,a.Iq)(i.H.auth,r);(0,a.d8)(n)?(e.login({...n,id:n._id},n.jwt),f({status:"success",text:"Вы авторизовались!"})):f({status:"error",text:"Неверные почта или пароль"})};return(0,s.useEffect)(()=>{let r;return e.user&&(r=setTimeout(()=>{f({status:null,text:null}),t.close()},1e3)),()=>clearTimeout(r)},[e.user]),(0,n.jsxs)("form",{onSubmit:m,className:u().form,children:[(0,n.jsx)("h2",{className:u().form__title,children:"Авторизация"}),(0,n.jsxs)("div",{className:u().form__fields,children:[(0,n.jsxs)("label",{className:u().form__field,children:[(0,n.jsx)("span",{className:u()["form__field-title"],children:"Email"}),(0,n.jsx)("input",{onInput:_,className:u()["form__field-input"],name:"email",type:"email",placeholder:"hello@world.com"})]}),(0,n.jsxs)("label",{className:u().form__field,children:[(0,n.jsx)("span",{className:u()["form__field-title"],children:"Пароль"}),(0,n.jsx)("input",{onInput:_,className:u()["form__field-input"],name:"password",type:"password",placeholder:"*********"})]})]}),l.status&&(0,n.jsx)("p",{className:u().form__message,children:l.text}),(0,n.jsxs)("div",{className:u().form__actions,children:[(0,n.jsx)("button",{className:u().form__reset,type:"reset",children:"Очистить"}),(0,n.jsx)("button",{className:u().form__submit,type:"submit",children:"Войти"})]})]})}},3080:function(t,e,r){"use strict";r.d(e,{o:function(){return h}});let n=t=>{let e;let r=new Set,n=(t,n)=>{let o="function"==typeof t?t(e):t;if(!Object.is(o,e)){let t=e;e=(null!=n?n:"object"!=typeof o||null===o)?o:Object.assign({},e,o),r.forEach(r=>r(e,t))}},o=()=>e,u={setState:n,getState:o,getInitialState:()=>s,subscribe:t=>(r.add(t),()=>r.delete(t)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},s=e=t(n,o,u);return u},o=t=>t?n(t):n;var u,s=r(2265),i=r(5401);let{useDebugValue:a}=s,{useSyncExternalStoreWithSelector:c}=i,l=!1,f=t=>t,_=t=>{"function"!=typeof t&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let e="function"==typeof t?o(t):t,r=(t,r)=>(function(t,e=f,r){r&&!l&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),l=!0);let n=c(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return a(n),n})(e,t,r);return Object.assign(r,e),r};var m=r(6493),d=r(1370);let h=(u=t=>({isAuth:!1,user:null,token:null,login:(e,r)=>{t({isAuth:!0,user:e,token:r}),(0,m.ZB)(r)},logout:()=>{t({isAuth:!1,user:null,token:null}),(0,m.Fw)()},checkAuth:async()=>{let e=(0,m.v_)();if(e){let r=await (0,m.jo)(d.H.me,e);r._id?(t({isAuth:!0,user:{...r,id:r._id},token:e}),(0,m.ZB)(e)):(t({isAuth:!1,user:null,token:null}),(0,m.Fw)())}else t({isAuth:!1,user:null,token:null})}}))?_(u):_},7965:function(t){t.exports={form:"AuthForm_form__SAM4_",form__title:"AuthForm_form__title__bh8UF",form__fields:"AuthForm_form__fields__9NEi0",form__field:"AuthForm_form__field__8_VIY","form__field-title":"AuthForm_form__field-title__KiNGx","form__field-input":"AuthForm_form__field-input__rnkmC",form__message:"AuthForm_form__message__jeZGO",form__actions:"AuthForm_form__actions__QgxEI",form__reset:"AuthForm_form__reset__t8DRW",form__submit:"AuthForm_form__submit__pJzk2"}},5455:function(t){t.exports={main:"login_main__U2mcH"}},622:function(t,e,r){"use strict";var n=r(2265),o=Symbol.for("react.element"),u=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,r){var n,u={},c=null,l=null;for(n in void 0!==r&&(c=""+r),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(l=e.ref),e)s.call(e,n)&&!a.hasOwnProperty(n)&&(u[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===u[n]&&(u[n]=e[n]);return{$$typeof:o,type:t,key:c,ref:l,props:u,_owner:i.current}}e.Fragment=u,e.jsx=c,e.jsxs=c},7437:function(t,e,r){"use strict";t.exports=r(622)},1853:function(t,e,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),o="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},u=n.useState,s=n.useEffect,i=n.useLayoutEffect,a=n.useDebugValue;function c(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!o(t,r)}catch(t){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var r=e(),n=u({inst:{value:r,getSnapshot:e}}),o=n[0].inst,l=n[1];return i(function(){o.value=r,o.getSnapshot=e,c(o)&&l({inst:o})},[t,r,e]),s(function(){return c(o)&&l({inst:o}),t(function(){c(o)&&l({inst:o})})},[t]),a(r),r};e.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:l},8704:function(t,e,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),o=r(6272),u="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},s=o.useSyncExternalStore,i=n.useRef,a=n.useEffect,c=n.useMemo,l=n.useDebugValue;e.useSyncExternalStoreWithSelector=function(t,e,r,n,o){var f=i(null);if(null===f.current){var _={hasValue:!1,value:null};f.current=_}else _=f.current;var m=s(t,(f=c(function(){function t(t){if(!a){if(a=!0,s=t,t=n(t),void 0!==o&&_.hasValue){var e=_.value;if(o(e,t))return i=e}return i=t}if(e=i,u(s,t))return e;var r=n(t);return void 0!==o&&o(e,r)?e:(s=t,i=r)}var s,i,a=!1,c=void 0===r?null:r;return[function(){return t(e())},null===c?void 0:function(){return t(c())}]},[e,r,n,o]))[0],f[1]);return a(function(){_.hasValue=!0,_.value=m},[m]),l(m),m}},6272:function(t,e,r){"use strict";t.exports=r(1853)},5401:function(t,e,r){"use strict";t.exports=r(8704)}},function(t){t.O(0,[971,938,744],function(){return t(t.s=3411)}),_N_E=t.O()}]);